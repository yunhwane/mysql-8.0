## 공통 코드 조회
- 결과적으로 실무에서는 공통 코드 때문에 SQL 이 매우 복잡해지고 개발자는 고통받는다.
- 이러한 단점을 극복할 수 있는 방안이 있는데 공통 코드 이름을 SQL 에서 조회하지 않고, 애플리케이션에서 별도로 조회하는 것이다.


### 기본 아이디어
- SQL 은 코드값만 조회한다.
- 애플리케이션에서 공통 코드를 별도로 조회한다.
- 애플리케이션에서 코드값을 이름으로 변환한다.


```sql
SELECT
  o.order_id,
  m.name AS member_name,
  m.grade,
  o.order_status,
  o.total_amount
FROM orders o
JOIN members m ON o.member_id = m.member_id
ORDER BY o.order_id;
```
그러면 SQL 의 코드 중복이 없어진다.

하지만 단점은 다량의 데이터베이스 조회가 일어난다.
```sql
-- 2단계: 주문 상태 코드 목록 조회
SELECT code, name
FROM common_code_detail
WHERE group_code = 'ORDER_STATUS';




-- 2단계: 회원 등급 코드 목록 조회
SELECT code, name
FROM common_code_detail
WHERE group_code = 'MEMBER_GRADE';
```

- 여기서 N+1 쿼리가 발생한다. 목록 조회할때 2번씩+++ 되기 때문이다.

### 방식1
- 장점
  - 한번의 쿼리로 모두 조회
  - 네트워크 통신 1
  - 데이터베이스 최적화 가능
 
- 단점
  - SQL 복잡
  - 공통 코드 조인 로직이 여러 SQL 중복
  - 공통 코드 테이블 구조 변경 시 모든 SQL 수정 필요
 
### 방식2
- 장점
  - SQL 단순
  - 공통 코드 조회 로직 중앙화
  - 유지보수 용이
- 단점
  - 추가 쿼리 필요(네트워크 통신 비용 증가)
  - N+1
  - 애플리케이션 로직 복잡도 증가
 
 

